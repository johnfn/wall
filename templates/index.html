{% extends "skeleton.html" %}
  
{% block title %}Home{% endblock %}

{% block content %}
  {% if user.is_authenticated and user.facebook_profile.is_authenticated %}
  <ul id="choices">
	<li><div class="tab"><strong><img src="{{ STATIC_URL }}icons/comment.png" alt=""/> Comment</strong></div></li>
	<li><a class="tab" href="javascript:void(0);"><strong><img src="{{ STATIC_URL }}icons/exclamation.png" alt=""/> Challenge</strong></a></li>
  </ul>
  <div class="clear"></div>
  {% include "postchallenge.html" with user=user candidates=candidates %}
  {% else %}
  <div class="warning">
    <p>If you want to post comments or challenge a candidate, connect with Facebook!</p>
  </div>
  {% endif %}

  <div id="sidebar">
    <div class="leaderboard">
      <h2>Leaderboard</h2>
      {% if candidates %}
      <ol>
        {% for candidate in candidates %}
          <li><a href = "/candidates/{{ candidate.username }}">{{ candidate.first_name }} {{ candidate.last_name }}</a>: {{ candidate.get_profile.challenges_answered }}/{{ candidate.get_profile.challenges }}</li>
        {% endfor %}
      </ol>
      {% else %}
        <p>No candidates yet!</p>
      {% endif %}
    </div>
    <div id="support">
      <h2>Support a candidate!</h2>
      <div> 
        {% for candidate in candidates %}
          {% if candidate != user_info.supports %}
            <a href="/support/{{ candidate }}"> {{ candidate }} </a>
          {% else %}
            {{ candidate }}
          {% endif %}
        {% empty %}
          <p>No candidates yet!</p>
        {% endfor %}
      </div>
    </div>
  </div>

  <div id="posts">
  {% for post in posts %}
    {# Show every top level post #}
	
    {% include "post.html" with post=post %}

    <div class="rightalittle">
      {% for comment in post.comment_set.all %}
        {% include "post.html" with post=comment %}
      {% endfor %}

      {% if not post.challenge_answered %}
        {% include "postcomment.html" with address="comment"  showchallenge="false" id=post.id %}
      {% endif %}
    </div>
  {% empty %}
    <p>No posts yet!</p>
  {% endfor %}
  </div>
  <div class="pagination"> 
    &laquo;
    {% for number in page_range %}
      {% if number != current_page %}
        <a href="/{{ number }}/">{{ number }}</a>
      {% else %}
        {{ number }}
      {% endif %}
    {% endfor %} 
    &raquo;
  </div>

{% endblock %}